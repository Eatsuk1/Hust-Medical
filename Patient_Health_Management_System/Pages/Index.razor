@page "/index"
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@inject ProtectedLocalStorage ProtectedLocalStorage
@inject IAccountService AccountService

@code{


    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            var value = await ProtectedLocalStorage.GetAsync<string>("access_token");
            if (String.IsNullOrEmpty(value.Value))
            {
                var auth0Token = await AccountService.TokenGenerator();
                await ProtectedLocalStorage.SetAsync("access_token", auth0Token.access_token);
                await ProtectedLocalStorage.SetAsync("expire_in", auth0Token.expires_in);
            }
            StateHasChanged();
        }
    }

    
}

