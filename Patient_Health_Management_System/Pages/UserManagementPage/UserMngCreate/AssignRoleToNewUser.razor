@inject IAccountService AccountService
@inject IUserService UserService

<MudDialog>
	<DialogContent>
		<MudText Typo="Typo.h6">Đang tạo người dùng mới...</MudText>
		<MudProgressCircular Indeterminate="true" Size="Size.Large" Color="Color.Primary" />
	</DialogContent>
</MudDialog>

@code {
	[CascadingParameter] MudDialogInstance MudDialog { get; set; }

	[Parameter]
	public HashSet<string> RoleIds { get; set; }

	[Parameter]
	public string AccessToken { get; set; }

	[Parameter]
	public UserForm UserForm { get; set; }
	
	[Parameter]
	public string AdminId { get; set; }

	protected override async Task OnInitializedAsync()
	{
		await UserService.CreateUser(UserForm, AdminId); //Thêm thông tin user vừa tạo trên Auth0 vào database
		await AccountService.AssignRolesToUserByUserId(UserForm.UserId, AccessToken, RoleIds);
		await Task.Delay(1000);
		MudDialog.Close(DialogResult.Ok(true));
	}
}
